:root {
    --primary-bg: #f4f7f9;
    --secondary-bg: #ffffff;
    --text-color: #1a1a1a;
    --accent-color: #007bff;
    --accent-hover: #0056b3;
    --sent-bubble-bg: #dcf8c6;
    --sent-bubble-text: #1a1a1a;
    --received-bubble-bg: #e9e9eb;
    --received-bubble-text: #1a1a1a;
    --border-color: #e0e0e0;
    --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    --font-family: 'Poppins', sans-serif;
    --notification-text: #888;
    --error-text: #dc3545;
    --ticks-color: #888;
    --ticks-read-color: #34b7f1;
}

.dark-theme {
    --primary-bg: #121212;
    --secondary-bg: #1e1e1e;
    --text-color: #e0e0e0;
    --accent-color: #0084ff;
    --accent-hover: #006dd1;
    --sent-bubble-bg: #056162;
    --sent-bubble-text: #e0e0e0;
    --received-bubble-bg: #333333;
    --border-color: #3a3a3a;
    --shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    --notification-text: #777;
    --error-text: #ff5c5c;
    --ticks-color: #aaa;
    --ticks-read-color: #34b7f1;
}

/* General Styles */
* { box-sizing: border-box; margin: 0; padding: 0; }
body {
    font-family: var(--font-family);
    background-color: var(--primary-bg);
    color: var(--text-color);
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    transition: background-color 0.3s, color 0.3s;
}

/* Containers & Screens */
.container {
    background-color: var(--secondary-bg);
    border-radius: 16px;
    box-shadow: var(--shadow);
    width: 95%;
    max-width: 450px;
    padding: 2rem;
    text-align: center;
    transition: all 0.3s ease;
}
.screen.hidden { display: none; }
.chat-container { display: flex; flex-direction: column; height: 90vh; max-height: 800px; width: 95%; max-width: 800px; padding: 0; }

/* Home Screen */
.logo { display: flex; justify-content: center; align-items: center; gap: 10px; color: var(--accent-color); margin-bottom: 0.5rem; }
.logo i { font-size: 2.5rem; }
h1 { font-size: 2.5rem; font-weight: 600; }
.tagline { color: #888; margin-bottom: 2rem; }
h2 { margin-bottom: 1.5rem; font-weight: 500; }
.error-text { color: var(--error-text); font-size: 0.9rem; margin-top: 1rem; }
.error-text.hidden { display: none; }

/* Forms */
button { background-color: var(--accent-color); color: white; border: none; padding: 12px 20px; border-radius: 8px; font-family: var(--font-family); font-size: 1rem; cursor: pointer; transition: background-color 0.2s; width: 100%; margin-top: 10px; }
button:hover { background-color: var(--accent-hover); }
input[type="text"] { width: 100%; padding: 12px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 1rem; font-family: var(--font-family); background-color: var(--primary-bg); color: var(--text-color); transition: border-color 0.2s, background-color 0.3s; }
input[type="text"]:focus { outline: none; border-color: var(--accent-color); }
.room-actions p { margin: 1rem 0; color: #aaa; }

/* Chat Area */
.chat-header { padding: 1rem; border-bottom: 1px solid var(--border-color); text-align: center; font-weight: 500; flex-shrink: 0; }
#room-code-display { font-weight: 600; color: var(--accent-color); }
.messages-area { flex-grow: 1; overflow-y: auto; padding: 1.5rem; display: flex; flex-direction: column; gap: 0.25rem; }

/* Messages */
.message { display: flex; flex-direction: column; max-width: 75%; animation: fadeIn 0.3s ease-out; margin-bottom: 1rem; }
.sender-name { font-size: 0.8rem; font-weight: 500; color: #999; margin-bottom: 4px; }
.message-bubble { position: relative; padding: 8px 12px; padding-right: 50px; border-radius: 12px; word-wrap: break-word; line-height: 1.4; text-align: left; }
.message.sent { align-self: flex-end; align-items: flex-end; }
.message.sent .message-bubble { background-color: var(--sent-bubble-bg); color: var(--sent-bubble-text); border-bottom-right-radius: 5px; }
.message.received { align-self: flex-start; align-items: flex-start; }
.message.received .message-bubble { background-color: var(--received-bubble-bg); color: var(--received-bubble-text); border-bottom-left-radius: 5px; padding-right: 12px; }

/* Read Receipts */
.message-status { position: absolute; bottom: 5px; right: 8px; font-size: 0.7rem; color: var(--ticks-color); }
.message-status .read { color: var(--ticks-read-color); }

/* File Messages & Loader */
.file-message { display: flex; align-items: center; gap: 10px; min-width: 250px; }
.file-icon { font-size: 2rem; color: var(--accent-color); }
.file-info { text-align: left; }
.file-info p { margin: 0; font-size: 0.9rem; font-weight: 500; }
.file-info .file-size { font-size: 0.8rem; color: #888; }

/* --- UPDATED DOWNLOAD BUTTON STYLE --- */
.download-btn {
    margin-left: auto;
    padding: 5px;
    background: none;
    border: none;
    font-size: 1.8rem; /* Bigger icon */
    color: var(--accent-color); /* Ensure it has a visible color */
    cursor: pointer;
    transition: transform 0.2s, opacity 0.2s;
    opacity: 0.8; /* Slightly transparent by default */
}
.download-btn:hover {
    transform: scale(1.15); /* Enlarge on hover */
    opacity: 1; /* Fully visible on hover */
}
/* ------------------------------------ */

.loader { width: 20px; height: 20px; border: 3px solid var(--border-color); border-top-color: var(--accent-color); border-radius: 50%; animation: spin 1s linear infinite; }
@keyframes spin { to { transform: rotate(360deg); } }

/* Notification Message */
.notification { text-align: center; font-size: 0.85rem; color: var(--notification-text); padding: 5px 0; }

.typing-indicator { padding: 0 1.5rem 0.5rem; font-style: italic; color: #999; height: 20px; font-size: 0.9rem; flex-shrink: 0; text-align: left; }
.chat-footer { padding: 1rem; border-top: 1px solid var(--border-color); flex-shrink: 0; }
#message-form { display: flex; gap: 10px; }
#message-form button, .file-upload-btn { width: 48px; height: 48px; flex-shrink: 0; display: flex; justify-content: center; align-items: center; font-size: 1.2rem; }
#message-input { flex-grow: 1; height: 48px; padding: 0 15px; }

/* Etc */
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
.theme-switcher { position: absolute; top: 20px; right: 20px; display: flex; align-items: center; gap: 10px; }
.switch { position: relative; display: inline-block; width: 50px; height: 26px; }
.switch input { opacity: 0; width: 0; height: 0; }
.slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; }
.slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 3px; bottom: 3px; background-color: white; transition: .4s; }
input:checked + .slider { background-color: var(--accent-color); }
input:checked + .slider:before { transform: translateX(24px); }
.slider.round { border-radius: 34px; }
.slider.round:before { border-radius: 50%; }

@media (max-width: 600px) { body { align-items: flex-start; padding-top: 2rem; } .container { width: 90%; } .chat-container { height: calc(100vh - 4rem); } }
